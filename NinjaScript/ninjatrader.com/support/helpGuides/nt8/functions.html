<!DOCTYPE html>
<html>
  
<!-- Mirrored from ninjatrader.com/support/helpGuides/nt8/functions.htm by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 26 Jan 2023 19:47:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <title>Operations &gt; Automated Trading &gt; Automated Trading Interface (ATI) &gt; DLL Interface &gt; Functions</title>
    <meta name="generator" content="Help &amp; Manual" />
    <meta name="keywords" content="" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link type="text/css" href="default.css" rel="stylesheet" />
    <link type="text/css" href="custom.css" rel="stylesheet">
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="nt_custom.js"></script>
    <style TYPE="text/css" media="screen">
    html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #FFFFFF;
    line-height: 1.15
    }
    
    div#printheader {
    display: none
    }
    #idheader {
    width: 100%;
    height: auto;
    padding: 0;
    margin: 0
    }
    #idcontent {
    position: relative
    }
    #callout-table, #overview-table {
    display: block;
    position: relative;
    top: 0;
    left: 0
    }
    #callout-icon {
    display: block;
    position: absolute;
    top: -11px;
    left: -11px
    }
    #callout-icon-flag {
    display: block;
    position: absolute;
    top: -11px;
    left: -8px
    }
    #callout-table a {
    text-decoration: none;
    color: blue
    }
    #callout-table a:visited {
    text-decoration: none;
    color: blue
    }
    #overview-table a {
    text-decoration: none;
    color: black
    }
    #overview-table a:visited {
    text-decoration: none;
    color: black
    }
    #callout-table a:hover, #overview-table a:hover {
    text-decoration: underline
    }
    #switchtoggles {
    text-align: right;
    padding: 0 5px 0 0;
    font-size: 90%
    }
    p.help-url {
    margin: 20px 0 5px 0;
    text-align: center;
    font-size: 80%;
    text-decoration: none
    }
    .sync-toc {
    color: #ffffff;
    font-size: 8pt;
    font-weight: bold;
    display: none
    }
    .sync-toc a {
    color: #ffffff;
    text-decoration: none;
    font-weight: bold
    }
    .sync-toc a:visited {
    color: #ffffff
    }
    .sync-toc a:hover {
    text-decoration: underline
    }
    .p_ToggleHeading:active {
    box-shadow: 0px 0px 4px #9ecaed
    }                    
    .Needs {
      border-color: #008000 !important;
      background-color: #f3f9f4;
    }
    .Under {
      border-color: #ffcc00 !important;
      background-color: #fffdf6;
    }
    </style>
    <noscript>
    <style type="text/css">
    html, body { overflow: auto; }
    </style>
    </noscript>
    <style type="text/css" media="print">
    span.f_Heading1 { color: black; }
    #idheader, #printheader img { display:none; }
    #printheader { display: block; margin-top: 20px; }
    #idcontent { margin-top: 10px; position:relative }
    </style>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="helpman_settings.js"></script>
    <script type="text/javascript" src="helpman_topicinit.js"></script>
    <script type="text/javascript" src="nsh.js"></script>
    
    
    
  
   <script type="text/javascript">
     HMSyncTOC("NT%20HelpGuide%20English.html", "functions.html");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
  <body>
    
    
    
    <div id="printheader"><p class="p_HeadingTopic"><span class="f_HeadingTopic">Functions</span></p>
</div>
    <div id="idheader">
      <div id="idheaderbg">
        <table style="width:100%;border:none;margin:0px;background:#A41E22" cellspacing="0" cellpadding="0">
          <tr valign="bottom">
            <td align="left" valign="bottom" class="topichead">
              <p class="sync-toc">&lt;&lt; <a rel="nofollow" href="NT%20HelpGuide%20English0c4e.html?functions.htm" target="_top">Click to Display Table of Contents</a> &gt;&gt;</p>
              <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
                
              <a href="operations.html">Operations</a> &gt; <a href="automated_trading.html">Automated Trading</a> &gt; <a href="automated_trading_interface_at.html">Automated Trading Interface (ATI)</a> &gt; <a href="dll_interface.html">DLL Interface</a>&nbsp;&gt;</p>
              <p class="p_HeadingTopic"><span class="f_HeadingTopic">Functions</span></p>

            </td>
            <td align="right" width="120" valign="middle" class="topichead" id="idnav">
              
              <a href="dll_interface.html"><img name="prev" src="leftArrow.png" border=0 alt="Previous page"></a>
              
              <a href="dll_interface.html"><img name=main src="upArrow.png" border=0 alt="Return to chapter overview"></a>
              <a href="tradestation_email_integration.html"><img name=next src="rightArrow.png" border=0 alt="Next page"></a>
              
            </td>
          </tr>
        </table>
<!-- PM review header         
        <div id="status" class="" style="margin-bottom: 0px; min-height: 25px;font-size: small; border-bottom: solid 3px;  padding: 5px;">
          <b></b>: <span id="explain"></span>
        </div>
-->        
        <!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
        
      </div>
    </div>
    
    <div id="idcontent">
      <div id="innerdiv">
        <!-- Ask Internet Explorer 6.users to update their obsolete and dangerous browser -->
        <!--[if lt IE 7]><div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;'><a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0000_us.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today." /></a></div><![endif]-->
        
        <!--ZOOMRESTART-->
        <h2 class="p_Heading2"><span class="f_Heading2">DLL Interface Functions</span></h2>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> Ask(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">price</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">size</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Sets the ask price and size for the specified instrument. A return value of 0 indicates success and -1 indicates an error.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> AskPlayback(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">price</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">size</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">timestamp</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Sets the ask price and size for the specified instrument for use when synchronizing NinjaTrader playback with an external application playback. A return value of 0 indicates success and -1 indicates an error. The <span style="font-style: italic;">timestamp</span> parameter format is &quot;yyyyMMddHHmmss&quot;.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> AvgEntryPrice(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">account</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the average entry price for the specified instrument/account combination.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> AvgFillPrice(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">orderId</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the average entry price for the specified orderId.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> Bid(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">price</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">size</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Sets the bid price and size for the specified instrument. A return value of 0 indicates success and -1 indicates an error.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> BidPlayback(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">price</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">size</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">timestamp</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Sets the bid price and size for the specified instrument for use when synchronizing NinjaTrader playback with an external application playback. A return value of 0 indicates success and -1 indicates an error. The <span style="font-style: italic;">timestamp</span> parameter format is &quot;yyyyMMddHHmmss&quot;.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> BuyingPower(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">account</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the buying power for the specified account. *Not all brokerage technologies support this value.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> CashValue(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">account</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the cash value for the specified account. *Not all brokerage technologies support this value.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> Command(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">command</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">account</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">action</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">quantity</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">orderType</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">limitPrice</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">stopPrice</span><span class="f_CodeExample" style="font-weight: bold;">, </span><br />
<span style="width:48px;display:inline-block">&nbsp;</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">timeInForce</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">oco</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">orderId</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">strategy</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">strategyId</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Function for submitting, cancelling and changing orders, positions and strategies. Refer to the <a href="commands_and_valid_parameters.html" class="topiclink">Commands and Valid Parameters</a> section for detailed information. The <span style="font-size: 10pt;"><a href="log_tab2.html" class="topiclink">Log</a></span> tab will list context sensitive error information.</p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> ConfirmOrders(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">confirm</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">The parameter confirm indicates if an order confirmation message will appear. This toggles the global option that can be set manually in the NinjaTrader Control Center by selecting the Tools menu and the menu item <span class="f_Menu">Options</span>, then checking the &quot;Confirm order placement&quot; checkbox. A value of 1 sets this option to true, any other value sets this option to false.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> Connected(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">showMessage</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Returns a value of zero if the DLL has established a connection to the NinjaTrader server (application) and if the ATI is currently enabled or, -1 if it is disconnected. Calling any function in the DLL will automatically initiate a connection to the server. The parameter <span style="font-style: italic;">showMessage</span> indicates if a message box is displayed in case the connection cannot be established. A value of 1 = show message box, any other value = don't show message box.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> Filled(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">orderId</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the number of contracts/shares filled for the orderId.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> Last(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">price</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">size</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Sets the last price and size for the specified instrument. A return value of 0 indicates success and -1 indicates an error.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> LastPlayback(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">price</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">size</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">timestamp</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Sets the last price and size for the specified instrument for use when synchronizing NinjaTrader playback with an external application playback. A return value of 0 indicates success and -1 indicates an error. The <span style="font-style: italic;">timestamp</span> parameter format is &quot;yyyyMMddHHmmss&quot;.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> MarketData(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">type</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the most recent price for the specified instrument and data type. 0 = last, 1 = bid, 2 = ask. You must first call the SubscribeMarketData() function prior to calling this function.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> MarketPosition(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">account</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the market position for an instrument/account combination. Returns 0 for flat, negative value for short positive value for long.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> NewOrderId()</span></p>
<p class="p_Normal">Gets a new unique order ID value.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> Orders(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">account</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets a string of order ID's of all orders of an account separated by '|'. *If a user defined order ID was not originally provided, the internal token ID value is used since it is guaranteed to be unique.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> OrderStatus(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">orderId</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the order state (see definitions) for the orderId. Returns an empty string if the order ID value provided does not return an order.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">double</span><span class="f_CodeExample" style="font-weight: bold;"> RealizedPnL(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">account</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the realized profit and loss of an account.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> SetUp(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">host</span><span class="f_CodeExample" style="font-weight: bold;">, </span><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">port</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Optional function to set the host and port number. By default, host is set to &quot;localhost&quot; and port is set to 36973. The default port number can be set via the General tab under Options. If you change these default values, this function must be called before any other function. A return value of 0 indicates success and -1 indicates an error.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> StopOrders(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">strategyId</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets a string of order ID's of all Stop Loss orders of an ATM Strategy separated by '|'. Internal token ID value is used since it is guaranteed to be unique.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> Strategies(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">account</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets a string of strategy ID's of all ATM Strategies of an account separated by '|'. Duplicate ID values can be returned if strategies were initiated outside of the ATI. </p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> StrategyPosition(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">strategyId</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets the position for a strategy. Returns 0 for flat, negative value for short and positive value for long.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> SubscribeMarketData(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Starts a market data stream for the specific instrument. Call the MarketData() function to retrieve prices. Make sure you call the UnSubscribeMarketData() function to close the data stream. A return value of 0 indicates success and -1 indicates an error.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> TargetOrders(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">strategyId</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Gets a string of order ID's of all Profit Target orders of an ATM Strategy separated by '|'. Internal token ID value is used since it is guaranteed to be unique.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> TearDown()</span></p>
<p class="p_Normal">Disconnects the DLL from the NinjaTrader server. A return value of 0 indicates success and -1 indicates an error.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample"><span class="f_CodeExampleTypes" style="font-weight: bold;">int</span><span class="f_CodeExample" style="font-weight: bold;"> UnsubscribeMarketData(</span><span class="f_CodeExampleTypes" style="font-weight: bold;">string</span><span class="f_CodeExample" style="font-weight: bold;"> </span><span class="f_CodeExampleParameters" style="font-weight: bold;">instrument</span><span class="f_CodeExample" style="font-weight: bold;">)</span></p>
<p class="p_Normal">Stops a market data stream for the specific instrument. A return value of 0 indicates success and -1 indicates an error.</p>

        <!--ZOOMSTOP-->
      </div>
      <script type="text/javascript">
      
      var lastSlashPos = document.URL.lastIndexOf("https://ninjatrader.com/") > document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("https://ninjatrader.com/") : document.URL.lastIndexOf("\\");
      if (document.URL.substring(lastSlashPos + 1, lastSlashPos + 4).toLowerCase() != "~hh") {
      if (document.all) setTimeout(function() {
      nsrInit();
      }, 20);
      else nsrInit();
      }
      
      
      if ((!parent.hmNavigationFrame) && (parent.location) && (parent.location.href)) {
      $('.sync-toc').show();
      $('p.crumbs').hide();
      }
      
      
      </script>
      <div id="bump" style="height: 25px"></div>
    </body>
  
<!-- Mirrored from ninjatrader.com/support/helpGuides/nt8/functions.htm by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 26 Jan 2023 19:47:02 GMT -->
</html>
